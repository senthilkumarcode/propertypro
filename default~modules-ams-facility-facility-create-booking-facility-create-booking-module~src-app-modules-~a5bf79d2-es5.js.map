{"version":3,"sources":["webpack:///node_modules/@fullcalendar/interaction/main.esm.js"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","touchMouseIgnoreWait","ignoreMouseDepth","listenerCnt","isWindowTouchMoveCancelled","PointerDragging","containerEl","_this","subjectEl","downEl","selector","handleSelector","shouldIgnoreMove","shouldWatchScroll","isDragging","isTouchDragging","wasTouchScroll","handleMouseDown","ev","shouldIgnoreMouse","isPrimaryMouseButton","tryStart","pev","createEventFromMouse","emitter","trigger","initScrollWatch","document","addEventListener","handleMouseMove","handleMouseUp","recordCoords","removeEventListener","cleanup","handleTouchStart","createEventFromTouch","target","handleTouchMove","handleTouchEnd","window","handleTouchScroll","startIgnoringMouse","handleScroll","pageX","pageXOffset","prevScrollX","prevPageX","pageY","pageYOffset","prevScrollY","prevPageY","origEvent","isTouch","deltaX","origPageX","deltaY","origPageY","passive","listenerCreated","destroy","listenerDestroyed","querySubjectEl","destroyScrollWatch","cancelTouchScroll","isFirst","touches","button","ctrlKey","setTimeout","onWindowTouchMove","preventDefault","ElementMirror","isVisible","sourceEl","mirrorEl","sourceElRect","parentNode","body","zIndex","revertDuration","start","getBoundingClientRect","origScreenX","origScreenY","updateElPosition","handleMove","setIsVisible","bool","style","display","stop","needsRevertAnimation","callback","done","doRevertAnimation","finalSourceElRect","transition","left","top","getMirrorEl","cloneNode","classList","add","position","visibility","boxSizing","width","right","height","bottom","margin","appendChild","ScrollGeomCache","_super","scrollController","doesListening","scrollTop","getScrollTop","scrollLeft","getScrollLeft","handleScrollChange","origScrollTop","origScrollLeft","scrollWidth","getScrollWidth","scrollHeight","getScrollHeight","clientWidth","getClientWidth","clientHeight","getClientHeight","clientRect","computeClientRect","getEventTarget","setScrollTop","Math","max","min","getMaxScrollTop","setScrollLeft","getMaxScrollLeft","ElementScrollGeomCache","el","WindowScrollGeomCache","getTime","performance","now","Date","AutoScroller","isEnabled","scrollQuery","edgeThreshold","maxVelocity","pointerScreenX","pointerScreenY","isAnimating","scrollCaches","everMovedUp","everMovedDown","everMovedLeft","everMovedRight","animate","edge","computeBestEdge","handleSide","msSinceRequest","requestAnimation","buildCaches","yDelta","xDelta","_i","_a","scrollCache","requestAnimationFrame","seconds","invDistance","distance","velocity","sign","name","bestSide","rect","leftDist","rightDist","topDist","bottomDist","canScrollUp","canScrollDown","canScrollLeft","canScrollRight","queryScrollEls","map","els","query","push","slice","querySelectorAll","FeaturefulElementDragging","delay","minDistance","touchScrollAllowed","mirrorNeedsRevert","isInteracting","isDelayEnded","isDistanceSurpassed","delayTimeoutId","onPointerDown","pointer","mirror","startDelay","handleDistanceSurpassed","onPointerMove","distanceSq","type","autoScroller","onPointerUp","tryStopDrag","clearTimeout","on","handleDelayEnd","tryStartDrag","stopDrag","bind","setIgnoreMove","setMirrorIsVisible","setMirrorNeedsRevert","setAutoScrollEnabled","OffsetTracker","origRect","computeLeft","computeTop","isWithinClipping","point","isIgnoredClipping","node","tagName","HitDragging","dragging","droppableStore","useSubjectCenter","requireInitial","initialHit","movingHit","finalHit","handlePointerDown","prepareHits","processFirstCoord","handleDragStart","handleDragMove","handlePointerUp","releaseHits","handleDragEnd","origPoint","adjustedPoint","subjectRect","queryHitForOffset","slicedSubjectRect","coordAdjust","forceHandle","hit","isHitsEqual","offsetTrackers","interactionSettings","component","buildPositionCaches","id","offsetLeft","offsetTop","bestHit","offsetTracker","originLeft","originTop","positionLeft","positionTop","queryHit","props","dateProfile","activeRange","dateSpan","range","layer","hit0","hit1","Boolean","DateClicking","settings","isValidDateDownEl","context","calendar","view","_b","hitDragging","triggerDateClick","dayEl","DateSelecting","dragSelection","options","canSelect","selectable","getComponentTouchDelay","unselect","handleHitUpdate","isFinal","isInvalid","joinHitsIntoSelection","pluginSystem","hooks","dateSelectionTransformers","isDateSelectionValid","dispatch","selection","triggerDateSelect","selectMinDistance","dragScroll","selectLongPressDelay","longPressDelay","dateSpan0","dateSpan1","ms","end","sort","dateSelectionTransformers_1","transformer","res","allDay","EventDragging","subjectSeg","eventRange","relevantEvents","receivingCalendar","validMutation","mutatedRelevantEvents","origTarget","initialCalendar","eventInstanceId","instance","instanceId","state","eventStore","eventDragMinDistance","eventSelection","getComponentTouchDelay$1","dragRevertDuration","isValid","isValidSegDownEl","contains","publiclyTrigger","event","def","jsEvent","mutation","interaction","affectedEvents","mutatedEvents","isEvent","origSeg","receivingComponent","receivingOptions","editable","droppable","computeEventMutation","eventDragMutationMassagers","eventUiBases","isInteractionValid","displayDrag","querySelector","initialCalendar_1","initialView","eventDef","eventInstance","eventApi","relevantEvents_1","clearDrag","transformed","eventDropTransformers","eventDropArg","delta","datesDelta","oldEvent","defs","defId","instances","revert","draggedEl","dropArg","buildDatePointApi","SELECTOR","useEventCenter","nextCalendar","prevCalendar","massagers","date0","date1","standardProps","hasEnd","allDayMaintainDuration","dateEnv","largeUnit","milliseconds","massagers_1","massager","eventLongPressDelay","EventDragging$1","draggingSeg","seg","querySeg","computeMutation","eventResizeJoinTransforms","startDelta","endDelta","prevEvent","fgSegSelector","isFromStart","instanceRange","transforms","transforms_1","transform","UnselectAuto","isRecentPointerDateSelect","onSelect","selectInfo","onDocumentPointerUp","documentPointer","dateSelection","unselectAuto","viewOpt","unselectCancel","off","ExternalElementDragging","suppliedDragMeta","droppableEvent","dragMeta","buildDragMeta","canDropElOnCalendar","computeEventForDateSpan","finalView","arg","getDragMetaFromEl","dropAccept","opt","defProps","leftoverProps","externalDefTransforms","sourceId","duration","startTime","getDefaultEventEnd","str","getEmbeddedElData","obj","JSON","parse","dataAttrPrefix","prefix","prefixedName","getAttribute","ExternalDraggable","itemSelector","appendTo","eventData","InferredElementDragging","mirrorSelector","currentMirrorEl","handlePointerMove","ThirdPartyDraggable","containerOrSettings","Element","main","componentInteractions","calendarInteractions","elementDraggingImpl"],"mappings":"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","file":"default~modules-ams-facility-facility-create-booking-facility-create-booking-module~src-app-modules-~a5bf79d2-es5.js","sourcesContent":["/*!\nFullCalendar Interaction Plugin v4.4.2\nDocs & License: https://fullcalendar.io/\n(c) 2019 Adam Shaw\n*/\n\nimport { config, elementClosest, EmitterMixin, applyStyle, whenTransitionDone, removeElement, ScrollController, ElementScrollController, computeInnerRect, WindowScrollController, preventSelection, preventContextMenu, allowSelection, allowContextMenu, ElementDragging, computeRect, getClippingParents, pointInsideRect, isDateSpansEqual, constrainPoint, intersectRects, getRectCenter, diffPoints, mapHash, rangeContainsRange, interactionSettingsToStore, Interaction, enableCursor, disableCursor, compareNumbers, getElSeg, getRelevantEvents, EventApi, createEmptyEventStore, applyMutationToEventStore, interactionSettingsStore, startOfDay, diffDates, createDuration, eventTupleToStore, isInteractionValid, parseDragMeta, elementMatches, parseEventDef, createEventInstance, globalDefaults, createPlugin } from '@fullcalendar/core';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\n\nconfig.touchMouseIgnoreWait = 500;\nvar ignoreMouseDepth = 0;\nvar listenerCnt = 0;\nvar isWindowTouchMoveCancelled = false;\n/*\nUses a \"pointer\" abstraction, which monitors UI events for both mouse and touch.\nTracks when the pointer \"drags\" on a certain element, meaning down+move+up.\n\nAlso, tracks if there was touch-scrolling.\nAlso, can prevent touch-scrolling from happening.\nAlso, can fire pointermove events when scrolling happens underneath, even when no real pointer movement.\n\nemits:\n- pointerdown\n- pointermove\n- pointerup\n*/\nvar PointerDragging = /** @class */ (function () {\n    function PointerDragging(containerEl) {\n        var _this = this;\n        this.subjectEl = null;\n        this.downEl = null;\n        // options that can be directly assigned by caller\n        this.selector = ''; // will cause subjectEl in all emitted events to be this element\n        this.handleSelector = '';\n        this.shouldIgnoreMove = false;\n        this.shouldWatchScroll = true; // for simulating pointermove on scroll\n        // internal states\n        this.isDragging = false;\n        this.isTouchDragging = false;\n        this.wasTouchScroll = false;\n        // Mouse\n        // ----------------------------------------------------------------------------------------------------\n        this.handleMouseDown = function (ev) {\n            if (!_this.shouldIgnoreMouse() &&\n                isPrimaryMouseButton(ev) &&\n                _this.tryStart(ev)) {\n                var pev = _this.createEventFromMouse(ev, true);\n                _this.emitter.trigger('pointerdown', pev);\n                _this.initScrollWatch(pev);\n                if (!_this.shouldIgnoreMove) {\n                    document.addEventListener('mousemove', _this.handleMouseMove);\n                }\n                document.addEventListener('mouseup', _this.handleMouseUp);\n            }\n        };\n        this.handleMouseMove = function (ev) {\n            var pev = _this.createEventFromMouse(ev);\n            _this.recordCoords(pev);\n            _this.emitter.trigger('pointermove', pev);\n        };\n        this.handleMouseUp = function (ev) {\n            document.removeEventListener('mousemove', _this.handleMouseMove);\n            document.removeEventListener('mouseup', _this.handleMouseUp);\n            _this.emitter.trigger('pointerup', _this.createEventFromMouse(ev));\n            _this.cleanup(); // call last so that pointerup has access to props\n        };\n        // Touch\n        // ----------------------------------------------------------------------------------------------------\n        this.handleTouchStart = function (ev) {\n            if (_this.tryStart(ev)) {\n                _this.isTouchDragging = true;\n                var pev = _this.createEventFromTouch(ev, true);\n                _this.emitter.trigger('pointerdown', pev);\n                _this.initScrollWatch(pev);\n                // unlike mouse, need to attach to target, not document\n                // https://stackoverflow.com/a/45760014\n                var target = ev.target;\n                if (!_this.shouldIgnoreMove) {\n                    target.addEventListener('touchmove', _this.handleTouchMove);\n                }\n                target.addEventListener('touchend', _this.handleTouchEnd);\n                target.addEventListener('touchcancel', _this.handleTouchEnd); // treat it as a touch end\n                // attach a handler to get called when ANY scroll action happens on the page.\n                // this was impossible to do with normal on/off because 'scroll' doesn't bubble.\n                // http://stackoverflow.com/a/32954565/96342\n                window.addEventListener('scroll', _this.handleTouchScroll, true // useCapture\n                );\n            }\n        };\n        this.handleTouchMove = function (ev) {\n            var pev = _this.createEventFromTouch(ev);\n            _this.recordCoords(pev);\n            _this.emitter.trigger('pointermove', pev);\n        };\n        this.handleTouchEnd = function (ev) {\n            if (_this.isDragging) { // done to guard against touchend followed by touchcancel\n                var target = ev.target;\n                target.removeEventListener('touchmove', _this.handleTouchMove);\n                target.removeEventListener('touchend', _this.handleTouchEnd);\n                target.removeEventListener('touchcancel', _this.handleTouchEnd);\n                window.removeEventListener('scroll', _this.handleTouchScroll, true); // useCaptured=true\n                _this.emitter.trigger('pointerup', _this.createEventFromTouch(ev));\n                _this.cleanup(); // call last so that pointerup has access to props\n                _this.isTouchDragging = false;\n                startIgnoringMouse();\n            }\n        };\n        this.handleTouchScroll = function () {\n            _this.wasTouchScroll = true;\n        };\n        this.handleScroll = function (ev) {\n            if (!_this.shouldIgnoreMove) {\n                var pageX = (window.pageXOffset - _this.prevScrollX) + _this.prevPageX;\n                var pageY = (window.pageYOffset - _this.prevScrollY) + _this.prevPageY;\n                _this.emitter.trigger('pointermove', {\n                    origEvent: ev,\n                    isTouch: _this.isTouchDragging,\n                    subjectEl: _this.subjectEl,\n                    pageX: pageX,\n                    pageY: pageY,\n                    deltaX: pageX - _this.origPageX,\n                    deltaY: pageY - _this.origPageY\n                });\n            }\n        };\n        this.containerEl = containerEl;\n        this.emitter = new EmitterMixin();\n        containerEl.addEventListener('mousedown', this.handleMouseDown);\n        containerEl.addEventListener('touchstart', this.handleTouchStart, { passive: true });\n        listenerCreated();\n    }\n    PointerDragging.prototype.destroy = function () {\n        this.containerEl.removeEventListener('mousedown', this.handleMouseDown);\n        this.containerEl.removeEventListener('touchstart', this.handleTouchStart, { passive: true });\n        listenerDestroyed();\n    };\n    PointerDragging.prototype.tryStart = function (ev) {\n        var subjectEl = this.querySubjectEl(ev);\n        var downEl = ev.target;\n        if (subjectEl &&\n            (!this.handleSelector || elementClosest(downEl, this.handleSelector))) {\n            this.subjectEl = subjectEl;\n            this.downEl = downEl;\n            this.isDragging = true; // do this first so cancelTouchScroll will work\n            this.wasTouchScroll = false;\n            return true;\n        }\n        return false;\n    };\n    PointerDragging.prototype.cleanup = function () {\n        isWindowTouchMoveCancelled = false;\n        this.isDragging = false;\n        this.subjectEl = null;\n        this.downEl = null;\n        // keep wasTouchScroll around for later access\n        this.destroyScrollWatch();\n    };\n    PointerDragging.prototype.querySubjectEl = function (ev) {\n        if (this.selector) {\n            return elementClosest(ev.target, this.selector);\n        }\n        else {\n            return this.containerEl;\n        }\n    };\n    PointerDragging.prototype.shouldIgnoreMouse = function () {\n        return ignoreMouseDepth || this.isTouchDragging;\n    };\n    // can be called by user of this class, to cancel touch-based scrolling for the current drag\n    PointerDragging.prototype.cancelTouchScroll = function () {\n        if (this.isDragging) {\n            isWindowTouchMoveCancelled = true;\n        }\n    };\n    // Scrolling that simulates pointermoves\n    // ----------------------------------------------------------------------------------------------------\n    PointerDragging.prototype.initScrollWatch = function (ev) {\n        if (this.shouldWatchScroll) {\n            this.recordCoords(ev);\n            window.addEventListener('scroll', this.handleScroll, true); // useCapture=true\n        }\n    };\n    PointerDragging.prototype.recordCoords = function (ev) {\n        if (this.shouldWatchScroll) {\n            this.prevPageX = ev.pageX;\n            this.prevPageY = ev.pageY;\n            this.prevScrollX = window.pageXOffset;\n            this.prevScrollY = window.pageYOffset;\n        }\n    };\n    PointerDragging.prototype.destroyScrollWatch = function () {\n        if (this.shouldWatchScroll) {\n            window.removeEventListener('scroll', this.handleScroll, true); // useCaptured=true\n        }\n    };\n    // Event Normalization\n    // ----------------------------------------------------------------------------------------------------\n    PointerDragging.prototype.createEventFromMouse = function (ev, isFirst) {\n        var deltaX = 0;\n        var deltaY = 0;\n        // TODO: repeat code\n        if (isFirst) {\n            this.origPageX = ev.pageX;\n            this.origPageY = ev.pageY;\n        }\n        else {\n            deltaX = ev.pageX - this.origPageX;\n            deltaY = ev.pageY - this.origPageY;\n        }\n        return {\n            origEvent: ev,\n            isTouch: false,\n            subjectEl: this.subjectEl,\n            pageX: ev.pageX,\n            pageY: ev.pageY,\n            deltaX: deltaX,\n            deltaY: deltaY\n        };\n    };\n    PointerDragging.prototype.createEventFromTouch = function (ev, isFirst) {\n        var touches = ev.touches;\n        var pageX;\n        var pageY;\n        var deltaX = 0;\n        var deltaY = 0;\n        // if touch coords available, prefer,\n        // because FF would give bad ev.pageX ev.pageY\n        if (touches && touches.length) {\n            pageX = touches[0].pageX;\n            pageY = touches[0].pageY;\n        }\n        else {\n            pageX = ev.pageX;\n            pageY = ev.pageY;\n        }\n        // TODO: repeat code\n        if (isFirst) {\n            this.origPageX = pageX;\n            this.origPageY = pageY;\n        }\n        else {\n            deltaX = pageX - this.origPageX;\n            deltaY = pageY - this.origPageY;\n        }\n        return {\n            origEvent: ev,\n            isTouch: true,\n            subjectEl: this.subjectEl,\n            pageX: pageX,\n            pageY: pageY,\n            deltaX: deltaX,\n            deltaY: deltaY\n        };\n    };\n    return PointerDragging;\n}());\n// Returns a boolean whether this was a left mouse click and no ctrl key (which means right click on Mac)\nfunction isPrimaryMouseButton(ev) {\n    return ev.button === 0 && !ev.ctrlKey;\n}\n// Ignoring fake mouse events generated by touch\n// ----------------------------------------------------------------------------------------------------\nfunction startIgnoringMouse() {\n    ignoreMouseDepth++;\n    setTimeout(function () {\n        ignoreMouseDepth--;\n    }, config.touchMouseIgnoreWait);\n}\n// We want to attach touchmove as early as possible for Safari\n// ----------------------------------------------------------------------------------------------------\nfunction listenerCreated() {\n    if (!(listenerCnt++)) {\n        window.addEventListener('touchmove', onWindowTouchMove, { passive: false });\n    }\n}\nfunction listenerDestroyed() {\n    if (!(--listenerCnt)) {\n        window.removeEventListener('touchmove', onWindowTouchMove, { passive: false });\n    }\n}\nfunction onWindowTouchMove(ev) {\n    if (isWindowTouchMoveCancelled) {\n        ev.preventDefault();\n    }\n}\n\n/*\nAn effect in which an element follows the movement of a pointer across the screen.\nThe moving element is a clone of some other element.\nMust call start + handleMove + stop.\n*/\nvar ElementMirror = /** @class */ (function () {\n    function ElementMirror() {\n        this.isVisible = false; // must be explicitly enabled\n        this.sourceEl = null;\n        this.mirrorEl = null;\n        this.sourceElRect = null; // screen coords relative to viewport\n        // options that can be set directly by caller\n        this.parentNode = document.body;\n        this.zIndex = 9999;\n        this.revertDuration = 0;\n    }\n    ElementMirror.prototype.start = function (sourceEl, pageX, pageY) {\n        this.sourceEl = sourceEl;\n        this.sourceElRect = this.sourceEl.getBoundingClientRect();\n        this.origScreenX = pageX - window.pageXOffset;\n        this.origScreenY = pageY - window.pageYOffset;\n        this.deltaX = 0;\n        this.deltaY = 0;\n        this.updateElPosition();\n    };\n    ElementMirror.prototype.handleMove = function (pageX, pageY) {\n        this.deltaX = (pageX - window.pageXOffset) - this.origScreenX;\n        this.deltaY = (pageY - window.pageYOffset) - this.origScreenY;\n        this.updateElPosition();\n    };\n    // can be called before start\n    ElementMirror.prototype.setIsVisible = function (bool) {\n        if (bool) {\n            if (!this.isVisible) {\n                if (this.mirrorEl) {\n                    this.mirrorEl.style.display = '';\n                }\n                this.isVisible = bool; // needs to happen before updateElPosition\n                this.updateElPosition(); // because was not updating the position while invisible\n            }\n        }\n        else {\n            if (this.isVisible) {\n                if (this.mirrorEl) {\n                    this.mirrorEl.style.display = 'none';\n                }\n                this.isVisible = bool;\n            }\n        }\n    };\n    // always async\n    ElementMirror.prototype.stop = function (needsRevertAnimation, callback) {\n        var _this = this;\n        var done = function () {\n            _this.cleanup();\n            callback();\n        };\n        if (needsRevertAnimation &&\n            this.mirrorEl &&\n            this.isVisible &&\n            this.revertDuration && // if 0, transition won't work\n            (this.deltaX || this.deltaY) // if same coords, transition won't work\n        ) {\n            this.doRevertAnimation(done, this.revertDuration);\n        }\n        else {\n            setTimeout(done, 0);\n        }\n    };\n    ElementMirror.prototype.doRevertAnimation = function (callback, revertDuration) {\n        var mirrorEl = this.mirrorEl;\n        var finalSourceElRect = this.sourceEl.getBoundingClientRect(); // because autoscrolling might have happened\n        mirrorEl.style.transition =\n            'top ' + revertDuration + 'ms,' +\n                'left ' + revertDuration + 'ms';\n        applyStyle(mirrorEl, {\n            left: finalSourceElRect.left,\n            top: finalSourceElRect.top\n        });\n        whenTransitionDone(mirrorEl, function () {\n            mirrorEl.style.transition = '';\n            callback();\n        });\n    };\n    ElementMirror.prototype.cleanup = function () {\n        if (this.mirrorEl) {\n            removeElement(this.mirrorEl);\n            this.mirrorEl = null;\n        }\n        this.sourceEl = null;\n    };\n    ElementMirror.prototype.updateElPosition = function () {\n        if (this.sourceEl && this.isVisible) {\n            applyStyle(this.getMirrorEl(), {\n                left: this.sourceElRect.left + this.deltaX,\n                top: this.sourceElRect.top + this.deltaY\n            });\n        }\n    };\n    ElementMirror.prototype.getMirrorEl = function () {\n        var sourceElRect = this.sourceElRect;\n        var mirrorEl = this.mirrorEl;\n        if (!mirrorEl) {\n            mirrorEl = this.mirrorEl = this.sourceEl.cloneNode(true); // cloneChildren=true\n            // we don't want long taps or any mouse interaction causing selection/menus.\n            // would use preventSelection(), but that prevents selectstart, causing problems.\n            mirrorEl.classList.add('fc-unselectable');\n            mirrorEl.classList.add('fc-dragging');\n            applyStyle(mirrorEl, {\n                position: 'fixed',\n                zIndex: this.zIndex,\n                visibility: '',\n                boxSizing: 'border-box',\n                width: sourceElRect.right - sourceElRect.left,\n                height: sourceElRect.bottom - sourceElRect.top,\n                right: 'auto',\n                bottom: 'auto',\n                margin: 0\n            });\n            this.parentNode.appendChild(mirrorEl);\n        }\n        return mirrorEl;\n    };\n    return ElementMirror;\n}());\n\n/*\nIs a cache for a given element's scroll information (all the info that ScrollController stores)\nin addition the \"client rectangle\" of the element.. the area within the scrollbars.\n\nThe cache can be in one of two modes:\n- doesListening:false - ignores when the container is scrolled by someone else\n- doesListening:true - watch for scrolling and update the cache\n*/\nvar ScrollGeomCache = /** @class */ (function (_super) {\n    __extends(ScrollGeomCache, _super);\n    function ScrollGeomCache(scrollController, doesListening) {\n        var _this = _super.call(this) || this;\n        _this.handleScroll = function () {\n            _this.scrollTop = _this.scrollController.getScrollTop();\n            _this.scrollLeft = _this.scrollController.getScrollLeft();\n            _this.handleScrollChange();\n        };\n        _this.scrollController = scrollController;\n        _this.doesListening = doesListening;\n        _this.scrollTop = _this.origScrollTop = scrollController.getScrollTop();\n        _this.scrollLeft = _this.origScrollLeft = scrollController.getScrollLeft();\n        _this.scrollWidth = scrollController.getScrollWidth();\n        _this.scrollHeight = scrollController.getScrollHeight();\n        _this.clientWidth = scrollController.getClientWidth();\n        _this.clientHeight = scrollController.getClientHeight();\n        _this.clientRect = _this.computeClientRect(); // do last in case it needs cached values\n        if (_this.doesListening) {\n            _this.getEventTarget().addEventListener('scroll', _this.handleScroll);\n        }\n        return _this;\n    }\n    ScrollGeomCache.prototype.destroy = function () {\n        if (this.doesListening) {\n            this.getEventTarget().removeEventListener('scroll', this.handleScroll);\n        }\n    };\n    ScrollGeomCache.prototype.getScrollTop = function () {\n        return this.scrollTop;\n    };\n    ScrollGeomCache.prototype.getScrollLeft = function () {\n        return this.scrollLeft;\n    };\n    ScrollGeomCache.prototype.setScrollTop = function (top) {\n        this.scrollController.setScrollTop(top);\n        if (!this.doesListening) {\n            // we are not relying on the element to normalize out-of-bounds scroll values\n            // so we need to sanitize ourselves\n            this.scrollTop = Math.max(Math.min(top, this.getMaxScrollTop()), 0);\n            this.handleScrollChange();\n        }\n    };\n    ScrollGeomCache.prototype.setScrollLeft = function (top) {\n        this.scrollController.setScrollLeft(top);\n        if (!this.doesListening) {\n            // we are not relying on the element to normalize out-of-bounds scroll values\n            // so we need to sanitize ourselves\n            this.scrollLeft = Math.max(Math.min(top, this.getMaxScrollLeft()), 0);\n            this.handleScrollChange();\n        }\n    };\n    ScrollGeomCache.prototype.getClientWidth = function () {\n        return this.clientWidth;\n    };\n    ScrollGeomCache.prototype.getClientHeight = function () {\n        return this.clientHeight;\n    };\n    ScrollGeomCache.prototype.getScrollWidth = function () {\n        return this.scrollWidth;\n    };\n    ScrollGeomCache.prototype.getScrollHeight = function () {\n        return this.scrollHeight;\n    };\n    ScrollGeomCache.prototype.handleScrollChange = function () {\n    };\n    return ScrollGeomCache;\n}(ScrollController));\nvar ElementScrollGeomCache = /** @class */ (function (_super) {\n    __extends(ElementScrollGeomCache, _super);\n    function ElementScrollGeomCache(el, doesListening) {\n        return _super.call(this, new ElementScrollController(el), doesListening) || this;\n    }\n    ElementScrollGeomCache.prototype.getEventTarget = function () {\n        return this.scrollController.el;\n    };\n    ElementScrollGeomCache.prototype.computeClientRect = function () {\n        return computeInnerRect(this.scrollController.el);\n    };\n    return ElementScrollGeomCache;\n}(ScrollGeomCache));\nvar WindowScrollGeomCache = /** @class */ (function (_super) {\n    __extends(WindowScrollGeomCache, _super);\n    function WindowScrollGeomCache(doesListening) {\n        return _super.call(this, new WindowScrollController(), doesListening) || this;\n    }\n    WindowScrollGeomCache.prototype.getEventTarget = function () {\n        return window;\n    };\n    WindowScrollGeomCache.prototype.computeClientRect = function () {\n        return {\n            left: this.scrollLeft,\n            right: this.scrollLeft + this.clientWidth,\n            top: this.scrollTop,\n            bottom: this.scrollTop + this.clientHeight\n        };\n    };\n    // the window is the only scroll object that changes it's rectangle relative\n    // to the document's topleft as it scrolls\n    WindowScrollGeomCache.prototype.handleScrollChange = function () {\n        this.clientRect = this.computeClientRect();\n    };\n    return WindowScrollGeomCache;\n}(ScrollGeomCache));\n\n// If available we are using native \"performance\" API instead of \"Date\"\n// Read more about it on MDN:\n// https://developer.mozilla.org/en-US/docs/Web/API/Performance\nvar getTime = typeof performance === 'function' ? performance.now : Date.now;\n/*\nFor a pointer interaction, automatically scrolls certain scroll containers when the pointer\napproaches the edge.\n\nThe caller must call start + handleMove + stop.\n*/\nvar AutoScroller = /** @class */ (function () {\n    function AutoScroller() {\n        var _this = this;\n        // options that can be set by caller\n        this.isEnabled = true;\n        this.scrollQuery = [window, '.fc-scroller'];\n        this.edgeThreshold = 50; // pixels\n        this.maxVelocity = 300; // pixels per second\n        // internal state\n        this.pointerScreenX = null;\n        this.pointerScreenY = null;\n        this.isAnimating = false;\n        this.scrollCaches = null;\n        // protect against the initial pointerdown being too close to an edge and starting the scroll\n        this.everMovedUp = false;\n        this.everMovedDown = false;\n        this.everMovedLeft = false;\n        this.everMovedRight = false;\n        this.animate = function () {\n            if (_this.isAnimating) { // wasn't cancelled between animation calls\n                var edge = _this.computeBestEdge(_this.pointerScreenX + window.pageXOffset, _this.pointerScreenY + window.pageYOffset);\n                if (edge) {\n                    var now = getTime();\n                    _this.handleSide(edge, (now - _this.msSinceRequest) / 1000);\n                    _this.requestAnimation(now);\n                }\n                else {\n                    _this.isAnimating = false; // will stop animation\n                }\n            }\n        };\n    }\n    AutoScroller.prototype.start = function (pageX, pageY) {\n        if (this.isEnabled) {\n            this.scrollCaches = this.buildCaches();\n            this.pointerScreenX = null;\n            this.pointerScreenY = null;\n            this.everMovedUp = false;\n            this.everMovedDown = false;\n            this.everMovedLeft = false;\n            this.everMovedRight = false;\n            this.handleMove(pageX, pageY);\n        }\n    };\n    AutoScroller.prototype.handleMove = function (pageX, pageY) {\n        if (this.isEnabled) {\n            var pointerScreenX = pageX - window.pageXOffset;\n            var pointerScreenY = pageY - window.pageYOffset;\n            var yDelta = this.pointerScreenY === null ? 0 : pointerScreenY - this.pointerScreenY;\n            var xDelta = this.pointerScreenX === null ? 0 : pointerScreenX - this.pointerScreenX;\n            if (yDelta < 0) {\n                this.everMovedUp = true;\n            }\n            else if (yDelta > 0) {\n                this.everMovedDown = true;\n            }\n            if (xDelta < 0) {\n                this.everMovedLeft = true;\n            }\n            else if (xDelta > 0) {\n                this.everMovedRight = true;\n            }\n            this.pointerScreenX = pointerScreenX;\n            this.pointerScreenY = pointerScreenY;\n            if (!this.isAnimating) {\n                this.isAnimating = true;\n                this.requestAnimation(getTime());\n            }\n        }\n    };\n    AutoScroller.prototype.stop = function () {\n        if (this.isEnabled) {\n            this.isAnimating = false; // will stop animation\n            for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n                var scrollCache = _a[_i];\n                scrollCache.destroy();\n            }\n            this.scrollCaches = null;\n        }\n    };\n    AutoScroller.prototype.requestAnimation = function (now) {\n        this.msSinceRequest = now;\n        requestAnimationFrame(this.animate);\n    };\n    AutoScroller.prototype.handleSide = function (edge, seconds) {\n        var scrollCache = edge.scrollCache;\n        var edgeThreshold = this.edgeThreshold;\n        var invDistance = edgeThreshold - edge.distance;\n        var velocity = // the closer to the edge, the faster we scroll\n         (invDistance * invDistance) / (edgeThreshold * edgeThreshold) * // quadratic\n            this.maxVelocity * seconds;\n        var sign = 1;\n        switch (edge.name) {\n            case 'left':\n                sign = -1;\n            // falls through\n            case 'right':\n                scrollCache.setScrollLeft(scrollCache.getScrollLeft() + velocity * sign);\n                break;\n            case 'top':\n                sign = -1;\n            // falls through\n            case 'bottom':\n                scrollCache.setScrollTop(scrollCache.getScrollTop() + velocity * sign);\n                break;\n        }\n    };\n    // left/top are relative to document topleft\n    AutoScroller.prototype.computeBestEdge = function (left, top) {\n        var edgeThreshold = this.edgeThreshold;\n        var bestSide = null;\n        for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n            var scrollCache = _a[_i];\n            var rect = scrollCache.clientRect;\n            var leftDist = left - rect.left;\n            var rightDist = rect.right - left;\n            var topDist = top - rect.top;\n            var bottomDist = rect.bottom - top;\n            // completely within the rect?\n            if (leftDist >= 0 && rightDist >= 0 && topDist >= 0 && bottomDist >= 0) {\n                if (topDist <= edgeThreshold && this.everMovedUp && scrollCache.canScrollUp() &&\n                    (!bestSide || bestSide.distance > topDist)) {\n                    bestSide = { scrollCache: scrollCache, name: 'top', distance: topDist };\n                }\n                if (bottomDist <= edgeThreshold && this.everMovedDown && scrollCache.canScrollDown() &&\n                    (!bestSide || bestSide.distance > bottomDist)) {\n                    bestSide = { scrollCache: scrollCache, name: 'bottom', distance: bottomDist };\n                }\n                if (leftDist <= edgeThreshold && this.everMovedLeft && scrollCache.canScrollLeft() &&\n                    (!bestSide || bestSide.distance > leftDist)) {\n                    bestSide = { scrollCache: scrollCache, name: 'left', distance: leftDist };\n                }\n                if (rightDist <= edgeThreshold && this.everMovedRight && scrollCache.canScrollRight() &&\n                    (!bestSide || bestSide.distance > rightDist)) {\n                    bestSide = { scrollCache: scrollCache, name: 'right', distance: rightDist };\n                }\n            }\n        }\n        return bestSide;\n    };\n    AutoScroller.prototype.buildCaches = function () {\n        return this.queryScrollEls().map(function (el) {\n            if (el === window) {\n                return new WindowScrollGeomCache(false); // false = don't listen to user-generated scrolls\n            }\n            else {\n                return new ElementScrollGeomCache(el, false); // false = don't listen to user-generated scrolls\n            }\n        });\n    };\n    AutoScroller.prototype.queryScrollEls = function () {\n        var els = [];\n        for (var _i = 0, _a = this.scrollQuery; _i < _a.length; _i++) {\n            var query = _a[_i];\n            if (typeof query === 'object') {\n                els.push(query);\n            }\n            else {\n                els.push.apply(els, Array.prototype.slice.call(document.querySelectorAll(query)));\n            }\n        }\n        return els;\n    };\n    return AutoScroller;\n}());\n\n/*\nMonitors dragging on an element. Has a number of high-level features:\n- minimum distance required before dragging\n- minimum wait time (\"delay\") before dragging\n- a mirror element that follows the pointer\n*/\nvar FeaturefulElementDragging = /** @class */ (function (_super) {\n    __extends(FeaturefulElementDragging, _super);\n    function FeaturefulElementDragging(containerEl) {\n        var _this = _super.call(this, containerEl) || this;\n        // options that can be directly set by caller\n        // the caller can also set the PointerDragging's options as well\n        _this.delay = null;\n        _this.minDistance = 0;\n        _this.touchScrollAllowed = true; // prevents drag from starting and blocks scrolling during drag\n        _this.mirrorNeedsRevert = false;\n        _this.isInteracting = false; // is the user validly moving the pointer? lasts until pointerup\n        _this.isDragging = false; // is it INTENTFULLY dragging? lasts until after revert animation\n        _this.isDelayEnded = false;\n        _this.isDistanceSurpassed = false;\n        _this.delayTimeoutId = null;\n        _this.onPointerDown = function (ev) {\n            if (!_this.isDragging) { // so new drag doesn't happen while revert animation is going\n                _this.isInteracting = true;\n                _this.isDelayEnded = false;\n                _this.isDistanceSurpassed = false;\n                preventSelection(document.body);\n                preventContextMenu(document.body);\n                // prevent links from being visited if there's an eventual drag.\n                // also prevents selection in older browsers (maybe?).\n                // not necessary for touch, besides, browser would complain about passiveness.\n                if (!ev.isTouch) {\n                    ev.origEvent.preventDefault();\n                }\n                _this.emitter.trigger('pointerdown', ev);\n                if (!_this.pointer.shouldIgnoreMove) {\n                    // actions related to initiating dragstart+dragmove+dragend...\n                    _this.mirror.setIsVisible(false); // reset. caller must set-visible\n                    _this.mirror.start(ev.subjectEl, ev.pageX, ev.pageY); // must happen on first pointer down\n                    _this.startDelay(ev);\n                    if (!_this.minDistance) {\n                        _this.handleDistanceSurpassed(ev);\n                    }\n                }\n            }\n        };\n        _this.onPointerMove = function (ev) {\n            if (_this.isInteracting) { // if false, still waiting for previous drag's revert\n                _this.emitter.trigger('pointermove', ev);\n                if (!_this.isDistanceSurpassed) {\n                    var minDistance = _this.minDistance;\n                    var distanceSq = void 0; // current distance from the origin, squared\n                    var deltaX = ev.deltaX, deltaY = ev.deltaY;\n                    distanceSq = deltaX * deltaX + deltaY * deltaY;\n                    if (distanceSq >= minDistance * minDistance) { // use pythagorean theorem\n                        _this.handleDistanceSurpassed(ev);\n                    }\n                }\n                if (_this.isDragging) {\n                    // a real pointer move? (not one simulated by scrolling)\n                    if (ev.origEvent.type !== 'scroll') {\n                        _this.mirror.handleMove(ev.pageX, ev.pageY);\n                        _this.autoScroller.handleMove(ev.pageX, ev.pageY);\n                    }\n                    _this.emitter.trigger('dragmove', ev);\n                }\n            }\n        };\n        _this.onPointerUp = function (ev) {\n            if (_this.isInteracting) { // if false, still waiting for previous drag's revert\n                _this.isInteracting = false;\n                allowSelection(document.body);\n                allowContextMenu(document.body);\n                _this.emitter.trigger('pointerup', ev); // can potentially set mirrorNeedsRevert\n                if (_this.isDragging) {\n                    _this.autoScroller.stop();\n                    _this.tryStopDrag(ev); // which will stop the mirror\n                }\n                if (_this.delayTimeoutId) {\n                    clearTimeout(_this.delayTimeoutId);\n                    _this.delayTimeoutId = null;\n                }\n            }\n        };\n        var pointer = _this.pointer = new PointerDragging(containerEl);\n        pointer.emitter.on('pointerdown', _this.onPointerDown);\n        pointer.emitter.on('pointermove', _this.onPointerMove);\n        pointer.emitter.on('pointerup', _this.onPointerUp);\n        _this.mirror = new ElementMirror();\n        _this.autoScroller = new AutoScroller();\n        return _this;\n    }\n    FeaturefulElementDragging.prototype.destroy = function () {\n        this.pointer.destroy();\n    };\n    FeaturefulElementDragging.prototype.startDelay = function (ev) {\n        var _this = this;\n        if (typeof this.delay === 'number') {\n            this.delayTimeoutId = setTimeout(function () {\n                _this.delayTimeoutId = null;\n                _this.handleDelayEnd(ev);\n            }, this.delay); // not assignable to number!\n        }\n        else {\n            this.handleDelayEnd(ev);\n        }\n    };\n    FeaturefulElementDragging.prototype.handleDelayEnd = function (ev) {\n        this.isDelayEnded = true;\n        this.tryStartDrag(ev);\n    };\n    FeaturefulElementDragging.prototype.handleDistanceSurpassed = function (ev) {\n        this.isDistanceSurpassed = true;\n        this.tryStartDrag(ev);\n    };\n    FeaturefulElementDragging.prototype.tryStartDrag = function (ev) {\n        if (this.isDelayEnded && this.isDistanceSurpassed) {\n            if (!this.pointer.wasTouchScroll || this.touchScrollAllowed) {\n                this.isDragging = true;\n                this.mirrorNeedsRevert = false;\n                this.autoScroller.start(ev.pageX, ev.pageY);\n                this.emitter.trigger('dragstart', ev);\n                if (this.touchScrollAllowed === false) {\n                    this.pointer.cancelTouchScroll();\n                }\n            }\n        }\n    };\n    FeaturefulElementDragging.prototype.tryStopDrag = function (ev) {\n        // .stop() is ALWAYS asynchronous, which we NEED because we want all pointerup events\n        // that come from the document to fire beforehand. much more convenient this way.\n        this.mirror.stop(this.mirrorNeedsRevert, this.stopDrag.bind(this, ev) // bound with args\n        );\n    };\n    FeaturefulElementDragging.prototype.stopDrag = function (ev) {\n        this.isDragging = false;\n        this.emitter.trigger('dragend', ev);\n    };\n    // fill in the implementations...\n    FeaturefulElementDragging.prototype.setIgnoreMove = function (bool) {\n        this.pointer.shouldIgnoreMove = bool;\n    };\n    FeaturefulElementDragging.prototype.setMirrorIsVisible = function (bool) {\n        this.mirror.setIsVisible(bool);\n    };\n    FeaturefulElementDragging.prototype.setMirrorNeedsRevert = function (bool) {\n        this.mirrorNeedsRevert = bool;\n    };\n    FeaturefulElementDragging.prototype.setAutoScrollEnabled = function (bool) {\n        this.autoScroller.isEnabled = bool;\n    };\n    return FeaturefulElementDragging;\n}(ElementDragging));\n\n/*\nWhen this class is instantiated, it records the offset of an element (relative to the document topleft),\nand continues to monitor scrolling, updating the cached coordinates if it needs to.\nDoes not access the DOM after instantiation, so highly performant.\n\nAlso keeps track of all scrolling/overflow:hidden containers that are parents of the given element\nand an determine if a given point is inside the combined clipping rectangle.\n*/\nvar OffsetTracker = /** @class */ (function () {\n    function OffsetTracker(el) {\n        this.origRect = computeRect(el);\n        // will work fine for divs that have overflow:hidden\n        this.scrollCaches = getClippingParents(el).map(function (el) {\n            return new ElementScrollGeomCache(el, true); // listen=true\n        });\n    }\n    OffsetTracker.prototype.destroy = function () {\n        for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n            var scrollCache = _a[_i];\n            scrollCache.destroy();\n        }\n    };\n    OffsetTracker.prototype.computeLeft = function () {\n        var left = this.origRect.left;\n        for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n            var scrollCache = _a[_i];\n            left += scrollCache.origScrollLeft - scrollCache.getScrollLeft();\n        }\n        return left;\n    };\n    OffsetTracker.prototype.computeTop = function () {\n        var top = this.origRect.top;\n        for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n            var scrollCache = _a[_i];\n            top += scrollCache.origScrollTop - scrollCache.getScrollTop();\n        }\n        return top;\n    };\n    OffsetTracker.prototype.isWithinClipping = function (pageX, pageY) {\n        var point = { left: pageX, top: pageY };\n        for (var _i = 0, _a = this.scrollCaches; _i < _a.length; _i++) {\n            var scrollCache = _a[_i];\n            if (!isIgnoredClipping(scrollCache.getEventTarget()) &&\n                !pointInsideRect(point, scrollCache.clientRect)) {\n                return false;\n            }\n        }\n        return true;\n    };\n    return OffsetTracker;\n}());\n// certain clipping containers should never constrain interactions, like <html> and <body>\n// https://github.com/fullcalendar/fullcalendar/issues/3615\nfunction isIgnoredClipping(node) {\n    var tagName = node.tagName;\n    return tagName === 'HTML' || tagName === 'BODY';\n}\n\n/*\nTracks movement over multiple droppable areas (aka \"hits\")\nthat exist in one or more DateComponents.\nRelies on an existing draggable.\n\nemits:\n- pointerdown\n- dragstart\n- hitchange - fires initially, even if not over a hit\n- pointerup\n- (hitchange - again, to null, if ended over a hit)\n- dragend\n*/\nvar HitDragging = /** @class */ (function () {\n    function HitDragging(dragging, droppableStore) {\n        var _this = this;\n        // options that can be set by caller\n        this.useSubjectCenter = false;\n        this.requireInitial = true; // if doesn't start out on a hit, won't emit any events\n        this.initialHit = null;\n        this.movingHit = null;\n        this.finalHit = null; // won't ever be populated if shouldIgnoreMove\n        this.handlePointerDown = function (ev) {\n            var dragging = _this.dragging;\n            _this.initialHit = null;\n            _this.movingHit = null;\n            _this.finalHit = null;\n            _this.prepareHits();\n            _this.processFirstCoord(ev);\n            if (_this.initialHit || !_this.requireInitial) {\n                dragging.setIgnoreMove(false);\n                _this.emitter.trigger('pointerdown', ev); // TODO: fire this before computing processFirstCoord, so listeners can cancel. this gets fired by almost every handler :(\n            }\n            else {\n                dragging.setIgnoreMove(true);\n            }\n        };\n        this.handleDragStart = function (ev) {\n            _this.emitter.trigger('dragstart', ev);\n            _this.handleMove(ev, true); // force = fire even if initially null\n        };\n        this.handleDragMove = function (ev) {\n            _this.emitter.trigger('dragmove', ev);\n            _this.handleMove(ev);\n        };\n        this.handlePointerUp = function (ev) {\n            _this.releaseHits();\n            _this.emitter.trigger('pointerup', ev);\n        };\n        this.handleDragEnd = function (ev) {\n            if (_this.movingHit) {\n                _this.emitter.trigger('hitupdate', null, true, ev);\n            }\n            _this.finalHit = _this.movingHit;\n            _this.movingHit = null;\n            _this.emitter.trigger('dragend', ev);\n        };\n        this.droppableStore = droppableStore;\n        dragging.emitter.on('pointerdown', this.handlePointerDown);\n        dragging.emitter.on('dragstart', this.handleDragStart);\n        dragging.emitter.on('dragmove', this.handleDragMove);\n        dragging.emitter.on('pointerup', this.handlePointerUp);\n        dragging.emitter.on('dragend', this.handleDragEnd);\n        this.dragging = dragging;\n        this.emitter = new EmitterMixin();\n    }\n    // sets initialHit\n    // sets coordAdjust\n    HitDragging.prototype.processFirstCoord = function (ev) {\n        var origPoint = { left: ev.pageX, top: ev.pageY };\n        var adjustedPoint = origPoint;\n        var subjectEl = ev.subjectEl;\n        var subjectRect;\n        if (subjectEl !== document) {\n            subjectRect = computeRect(subjectEl);\n            adjustedPoint = constrainPoint(adjustedPoint, subjectRect);\n        }\n        var initialHit = this.initialHit = this.queryHitForOffset(adjustedPoint.left, adjustedPoint.top);\n        if (initialHit) {\n            if (this.useSubjectCenter && subjectRect) {\n                var slicedSubjectRect = intersectRects(subjectRect, initialHit.rect);\n                if (slicedSubjectRect) {\n                    adjustedPoint = getRectCenter(slicedSubjectRect);\n                }\n            }\n            this.coordAdjust = diffPoints(adjustedPoint, origPoint);\n        }\n        else {\n            this.coordAdjust = { left: 0, top: 0 };\n        }\n    };\n    HitDragging.prototype.handleMove = function (ev, forceHandle) {\n        var hit = this.queryHitForOffset(ev.pageX + this.coordAdjust.left, ev.pageY + this.coordAdjust.top);\n        if (forceHandle || !isHitsEqual(this.movingHit, hit)) {\n            this.movingHit = hit;\n            this.emitter.trigger('hitupdate', hit, false, ev);\n        }\n    };\n    HitDragging.prototype.prepareHits = function () {\n        this.offsetTrackers = mapHash(this.droppableStore, function (interactionSettings) {\n            interactionSettings.component.buildPositionCaches();\n            return new OffsetTracker(interactionSettings.el);\n        });\n    };\n    HitDragging.prototype.releaseHits = function () {\n        var offsetTrackers = this.offsetTrackers;\n        for (var id in offsetTrackers) {\n            offsetTrackers[id].destroy();\n        }\n        this.offsetTrackers = {};\n    };\n    HitDragging.prototype.queryHitForOffset = function (offsetLeft, offsetTop) {\n        var _a = this, droppableStore = _a.droppableStore, offsetTrackers = _a.offsetTrackers;\n        var bestHit = null;\n        for (var id in droppableStore) {\n            var component = droppableStore[id].component;\n            var offsetTracker = offsetTrackers[id];\n            if (offsetTracker.isWithinClipping(offsetLeft, offsetTop)) {\n                var originLeft = offsetTracker.computeLeft();\n                var originTop = offsetTracker.computeTop();\n                var positionLeft = offsetLeft - originLeft;\n                var positionTop = offsetTop - originTop;\n                var origRect = offsetTracker.origRect;\n                var width = origRect.right - origRect.left;\n                var height = origRect.bottom - origRect.top;\n                if (\n                // must be within the element's bounds\n                positionLeft >= 0 && positionLeft < width &&\n                    positionTop >= 0 && positionTop < height) {\n                    var hit = component.queryHit(positionLeft, positionTop, width, height);\n                    if (hit &&\n                        (\n                        // make sure the hit is within activeRange, meaning it's not a deal cell\n                        !component.props.dateProfile || // hack for DayTile\n                            rangeContainsRange(component.props.dateProfile.activeRange, hit.dateSpan.range)) &&\n                        (!bestHit || hit.layer > bestHit.layer)) {\n                        // TODO: better way to re-orient rectangle\n                        hit.rect.left += originLeft;\n                        hit.rect.right += originLeft;\n                        hit.rect.top += originTop;\n                        hit.rect.bottom += originTop;\n                        bestHit = hit;\n                    }\n                }\n            }\n        }\n        return bestHit;\n    };\n    return HitDragging;\n}());\nfunction isHitsEqual(hit0, hit1) {\n    if (!hit0 && !hit1) {\n        return true;\n    }\n    if (Boolean(hit0) !== Boolean(hit1)) {\n        return false;\n    }\n    return isDateSpansEqual(hit0.dateSpan, hit1.dateSpan);\n}\n\n/*\nMonitors when the user clicks on a specific date/time of a component.\nA pointerdown+pointerup on the same \"hit\" constitutes a click.\n*/\nvar DateClicking = /** @class */ (function (_super) {\n    __extends(DateClicking, _super);\n    function DateClicking(settings) {\n        var _this = _super.call(this, settings) || this;\n        _this.handlePointerDown = function (ev) {\n            var dragging = _this.dragging;\n            // do this in pointerdown (not dragend) because DOM might be mutated by the time dragend is fired\n            dragging.setIgnoreMove(!_this.component.isValidDateDownEl(dragging.pointer.downEl));\n        };\n        // won't even fire if moving was ignored\n        _this.handleDragEnd = function (ev) {\n            var component = _this.component;\n            var _a = component.context, calendar = _a.calendar, view = _a.view;\n            var pointer = _this.dragging.pointer;\n            if (!pointer.wasTouchScroll) {\n                var _b = _this.hitDragging, initialHit = _b.initialHit, finalHit = _b.finalHit;\n                if (initialHit && finalHit && isHitsEqual(initialHit, finalHit)) {\n                    calendar.triggerDateClick(initialHit.dateSpan, initialHit.dayEl, view, ev.origEvent);\n                }\n            }\n        };\n        var component = settings.component;\n        // we DO want to watch pointer moves because otherwise finalHit won't get populated\n        _this.dragging = new FeaturefulElementDragging(component.el);\n        _this.dragging.autoScroller.isEnabled = false;\n        var hitDragging = _this.hitDragging = new HitDragging(_this.dragging, interactionSettingsToStore(settings));\n        hitDragging.emitter.on('pointerdown', _this.handlePointerDown);\n        hitDragging.emitter.on('dragend', _this.handleDragEnd);\n        return _this;\n    }\n    DateClicking.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    return DateClicking;\n}(Interaction));\n\n/*\nTracks when the user selects a portion of time of a component,\nconstituted by a drag over date cells, with a possible delay at the beginning of the drag.\n*/\nvar DateSelecting = /** @class */ (function (_super) {\n    __extends(DateSelecting, _super);\n    function DateSelecting(settings) {\n        var _this = _super.call(this, settings) || this;\n        _this.dragSelection = null;\n        _this.handlePointerDown = function (ev) {\n            var _a = _this, component = _a.component, dragging = _a.dragging;\n            var options = component.context.options;\n            var canSelect = options.selectable &&\n                component.isValidDateDownEl(ev.origEvent.target);\n            // don't bother to watch expensive moves if component won't do selection\n            dragging.setIgnoreMove(!canSelect);\n            // if touch, require user to hold down\n            dragging.delay = ev.isTouch ? getComponentTouchDelay(component) : null;\n        };\n        _this.handleDragStart = function (ev) {\n            _this.component.context.calendar.unselect(ev); // unselect previous selections\n        };\n        _this.handleHitUpdate = function (hit, isFinal) {\n            var calendar = _this.component.context.calendar;\n            var dragSelection = null;\n            var isInvalid = false;\n            if (hit) {\n                dragSelection = joinHitsIntoSelection(_this.hitDragging.initialHit, hit, calendar.pluginSystem.hooks.dateSelectionTransformers);\n                if (!dragSelection || !_this.component.isDateSelectionValid(dragSelection)) {\n                    isInvalid = true;\n                    dragSelection = null;\n                }\n            }\n            if (dragSelection) {\n                calendar.dispatch({ type: 'SELECT_DATES', selection: dragSelection });\n            }\n            else if (!isFinal) { // only unselect if moved away while dragging\n                calendar.dispatch({ type: 'UNSELECT_DATES' });\n            }\n            if (!isInvalid) {\n                enableCursor();\n            }\n            else {\n                disableCursor();\n            }\n            if (!isFinal) {\n                _this.dragSelection = dragSelection; // only clear if moved away from all hits while dragging\n            }\n        };\n        _this.handlePointerUp = function (pev) {\n            if (_this.dragSelection) {\n                // selection is already rendered, so just need to report selection\n                _this.component.context.calendar.triggerDateSelect(_this.dragSelection, pev);\n                _this.dragSelection = null;\n            }\n        };\n        var component = settings.component;\n        var options = component.context.options;\n        var dragging = _this.dragging = new FeaturefulElementDragging(component.el);\n        dragging.touchScrollAllowed = false;\n        dragging.minDistance = options.selectMinDistance || 0;\n        dragging.autoScroller.isEnabled = options.dragScroll;\n        var hitDragging = _this.hitDragging = new HitDragging(_this.dragging, interactionSettingsToStore(settings));\n        hitDragging.emitter.on('pointerdown', _this.handlePointerDown);\n        hitDragging.emitter.on('dragstart', _this.handleDragStart);\n        hitDragging.emitter.on('hitupdate', _this.handleHitUpdate);\n        hitDragging.emitter.on('pointerup', _this.handlePointerUp);\n        return _this;\n    }\n    DateSelecting.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    return DateSelecting;\n}(Interaction));\nfunction getComponentTouchDelay(component) {\n    var options = component.context.options;\n    var delay = options.selectLongPressDelay;\n    if (delay == null) {\n        delay = options.longPressDelay;\n    }\n    return delay;\n}\nfunction joinHitsIntoSelection(hit0, hit1, dateSelectionTransformers) {\n    var dateSpan0 = hit0.dateSpan;\n    var dateSpan1 = hit1.dateSpan;\n    var ms = [\n        dateSpan0.range.start,\n        dateSpan0.range.end,\n        dateSpan1.range.start,\n        dateSpan1.range.end\n    ];\n    ms.sort(compareNumbers);\n    var props = {};\n    for (var _i = 0, dateSelectionTransformers_1 = dateSelectionTransformers; _i < dateSelectionTransformers_1.length; _i++) {\n        var transformer = dateSelectionTransformers_1[_i];\n        var res = transformer(hit0, hit1);\n        if (res === false) {\n            return null;\n        }\n        else if (res) {\n            __assign(props, res);\n        }\n    }\n    props.range = { start: ms[0], end: ms[3] };\n    props.allDay = dateSpan0.allDay;\n    return props;\n}\n\nvar EventDragging = /** @class */ (function (_super) {\n    __extends(EventDragging, _super);\n    function EventDragging(settings) {\n        var _this = _super.call(this, settings) || this;\n        // internal state\n        _this.subjectSeg = null; // the seg being selected/dragged\n        _this.isDragging = false;\n        _this.eventRange = null;\n        _this.relevantEvents = null; // the events being dragged\n        _this.receivingCalendar = null;\n        _this.validMutation = null;\n        _this.mutatedRelevantEvents = null;\n        _this.handlePointerDown = function (ev) {\n            var origTarget = ev.origEvent.target;\n            var _a = _this, component = _a.component, dragging = _a.dragging;\n            var mirror = dragging.mirror;\n            var options = component.context.options;\n            var initialCalendar = component.context.calendar;\n            var subjectSeg = _this.subjectSeg = getElSeg(ev.subjectEl);\n            var eventRange = _this.eventRange = subjectSeg.eventRange;\n            var eventInstanceId = eventRange.instance.instanceId;\n            _this.relevantEvents = getRelevantEvents(initialCalendar.state.eventStore, eventInstanceId);\n            dragging.minDistance = ev.isTouch ? 0 : options.eventDragMinDistance;\n            dragging.delay =\n                // only do a touch delay if touch and this event hasn't been selected yet\n                (ev.isTouch && eventInstanceId !== component.props.eventSelection) ?\n                    getComponentTouchDelay$1(component) :\n                    null;\n            mirror.parentNode = initialCalendar.el;\n            mirror.revertDuration = options.dragRevertDuration;\n            var isValid = component.isValidSegDownEl(origTarget) &&\n                !elementClosest(origTarget, '.fc-resizer'); // NOT on a resizer\n            dragging.setIgnoreMove(!isValid);\n            // disable dragging for elements that are resizable (ie, selectable)\n            // but are not draggable\n            _this.isDragging = isValid &&\n                ev.subjectEl.classList.contains('fc-draggable');\n        };\n        _this.handleDragStart = function (ev) {\n            var context = _this.component.context;\n            var initialCalendar = context.calendar;\n            var eventRange = _this.eventRange;\n            var eventInstanceId = eventRange.instance.instanceId;\n            if (ev.isTouch) {\n                // need to select a different event?\n                if (eventInstanceId !== _this.component.props.eventSelection) {\n                    initialCalendar.dispatch({ type: 'SELECT_EVENT', eventInstanceId: eventInstanceId });\n                }\n            }\n            else {\n                // if now using mouse, but was previous touch interaction, clear selected event\n                initialCalendar.dispatch({ type: 'UNSELECT_EVENT' });\n            }\n            if (_this.isDragging) {\n                initialCalendar.unselect(ev); // unselect *date* selection\n                initialCalendar.publiclyTrigger('eventDragStart', [\n                    {\n                        el: _this.subjectSeg.el,\n                        event: new EventApi(initialCalendar, eventRange.def, eventRange.instance),\n                        jsEvent: ev.origEvent,\n                        view: context.view\n                    }\n                ]);\n            }\n        };\n        _this.handleHitUpdate = function (hit, isFinal) {\n            if (!_this.isDragging) {\n                return;\n            }\n            var relevantEvents = _this.relevantEvents;\n            var initialHit = _this.hitDragging.initialHit;\n            var initialCalendar = _this.component.context.calendar;\n            // states based on new hit\n            var receivingCalendar = null;\n            var mutation = null;\n            var mutatedRelevantEvents = null;\n            var isInvalid = false;\n            var interaction = {\n                affectedEvents: relevantEvents,\n                mutatedEvents: createEmptyEventStore(),\n                isEvent: true,\n                origSeg: _this.subjectSeg\n            };\n            if (hit) {\n                var receivingComponent = hit.component;\n                receivingCalendar = receivingComponent.context.calendar;\n                var receivingOptions = receivingComponent.context.options;\n                if (initialCalendar === receivingCalendar ||\n                    receivingOptions.editable && receivingOptions.droppable) {\n                    mutation = computeEventMutation(initialHit, hit, receivingCalendar.pluginSystem.hooks.eventDragMutationMassagers);\n                    if (mutation) {\n                        mutatedRelevantEvents = applyMutationToEventStore(relevantEvents, receivingCalendar.eventUiBases, mutation, receivingCalendar);\n                        interaction.mutatedEvents = mutatedRelevantEvents;\n                        if (!receivingComponent.isInteractionValid(interaction)) {\n                            isInvalid = true;\n                            mutation = null;\n                            mutatedRelevantEvents = null;\n                            interaction.mutatedEvents = createEmptyEventStore();\n                        }\n                    }\n                }\n                else {\n                    receivingCalendar = null;\n                }\n            }\n            _this.displayDrag(receivingCalendar, interaction);\n            if (!isInvalid) {\n                enableCursor();\n            }\n            else {\n                disableCursor();\n            }\n            if (!isFinal) {\n                if (initialCalendar === receivingCalendar && // TODO: write test for this\n                    isHitsEqual(initialHit, hit)) {\n                    mutation = null;\n                }\n                _this.dragging.setMirrorNeedsRevert(!mutation);\n                // render the mirror if no already-rendered mirror\n                // TODO: wish we could somehow wait for dispatch to guarantee render\n                _this.dragging.setMirrorIsVisible(!hit || !document.querySelector('.fc-mirror'));\n                // assign states based on new hit\n                _this.receivingCalendar = receivingCalendar;\n                _this.validMutation = mutation;\n                _this.mutatedRelevantEvents = mutatedRelevantEvents;\n            }\n        };\n        _this.handlePointerUp = function () {\n            if (!_this.isDragging) {\n                _this.cleanup(); // because handleDragEnd won't fire\n            }\n        };\n        _this.handleDragEnd = function (ev) {\n            if (_this.isDragging) {\n                var context = _this.component.context;\n                var initialCalendar_1 = context.calendar;\n                var initialView = context.view;\n                var _a = _this, receivingCalendar = _a.receivingCalendar, validMutation = _a.validMutation;\n                var eventDef = _this.eventRange.def;\n                var eventInstance = _this.eventRange.instance;\n                var eventApi = new EventApi(initialCalendar_1, eventDef, eventInstance);\n                var relevantEvents_1 = _this.relevantEvents;\n                var mutatedRelevantEvents = _this.mutatedRelevantEvents;\n                var finalHit = _this.hitDragging.finalHit;\n                _this.clearDrag(); // must happen after revert animation\n                initialCalendar_1.publiclyTrigger('eventDragStop', [\n                    {\n                        el: _this.subjectSeg.el,\n                        event: eventApi,\n                        jsEvent: ev.origEvent,\n                        view: initialView\n                    }\n                ]);\n                if (validMutation) {\n                    // dropped within same calendar\n                    if (receivingCalendar === initialCalendar_1) {\n                        initialCalendar_1.dispatch({\n                            type: 'MERGE_EVENTS',\n                            eventStore: mutatedRelevantEvents\n                        });\n                        var transformed = {};\n                        for (var _i = 0, _b = initialCalendar_1.pluginSystem.hooks.eventDropTransformers; _i < _b.length; _i++) {\n                            var transformer = _b[_i];\n                            __assign(transformed, transformer(validMutation, initialCalendar_1));\n                        }\n                        var eventDropArg = __assign({}, transformed, { el: ev.subjectEl, delta: validMutation.datesDelta, oldEvent: eventApi, event: new EventApi(// the data AFTER the mutation\n                            initialCalendar_1, mutatedRelevantEvents.defs[eventDef.defId], eventInstance ? mutatedRelevantEvents.instances[eventInstance.instanceId] : null), revert: function () {\n                                initialCalendar_1.dispatch({\n                                    type: 'MERGE_EVENTS',\n                                    eventStore: relevantEvents_1\n                                });\n                            }, jsEvent: ev.origEvent, view: initialView });\n                        initialCalendar_1.publiclyTrigger('eventDrop', [eventDropArg]);\n                        // dropped in different calendar\n                    }\n                    else if (receivingCalendar) {\n                        initialCalendar_1.publiclyTrigger('eventLeave', [\n                            {\n                                draggedEl: ev.subjectEl,\n                                event: eventApi,\n                                view: initialView\n                            }\n                        ]);\n                        initialCalendar_1.dispatch({\n                            type: 'REMOVE_EVENT_INSTANCES',\n                            instances: _this.mutatedRelevantEvents.instances\n                        });\n                        receivingCalendar.dispatch({\n                            type: 'MERGE_EVENTS',\n                            eventStore: _this.mutatedRelevantEvents\n                        });\n                        if (ev.isTouch) {\n                            receivingCalendar.dispatch({\n                                type: 'SELECT_EVENT',\n                                eventInstanceId: eventInstance.instanceId\n                            });\n                        }\n                        var dropArg = __assign({}, receivingCalendar.buildDatePointApi(finalHit.dateSpan), { draggedEl: ev.subjectEl, jsEvent: ev.origEvent, view: finalHit.component // should this be finalHit.component.view? See #4644\n                         });\n                        receivingCalendar.publiclyTrigger('drop', [dropArg]);\n                        receivingCalendar.publiclyTrigger('eventReceive', [\n                            {\n                                draggedEl: ev.subjectEl,\n                                event: new EventApi(// the data AFTER the mutation\n                                receivingCalendar, mutatedRelevantEvents.defs[eventDef.defId], mutatedRelevantEvents.instances[eventInstance.instanceId]),\n                                view: finalHit.component // should this be finalHit.component.view? See #4644\n                            }\n                        ]);\n                    }\n                }\n                else {\n                    initialCalendar_1.publiclyTrigger('_noEventDrop');\n                }\n            }\n            _this.cleanup();\n        };\n        var component = _this.component;\n        var options = component.context.options;\n        var dragging = _this.dragging = new FeaturefulElementDragging(component.el);\n        dragging.pointer.selector = EventDragging.SELECTOR;\n        dragging.touchScrollAllowed = false;\n        dragging.autoScroller.isEnabled = options.dragScroll;\n        var hitDragging = _this.hitDragging = new HitDragging(_this.dragging, interactionSettingsStore);\n        hitDragging.useSubjectCenter = settings.useEventCenter;\n        hitDragging.emitter.on('pointerdown', _this.handlePointerDown);\n        hitDragging.emitter.on('dragstart', _this.handleDragStart);\n        hitDragging.emitter.on('hitupdate', _this.handleHitUpdate);\n        hitDragging.emitter.on('pointerup', _this.handlePointerUp);\n        hitDragging.emitter.on('dragend', _this.handleDragEnd);\n        return _this;\n    }\n    EventDragging.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    // render a drag state on the next receivingCalendar\n    EventDragging.prototype.displayDrag = function (nextCalendar, state) {\n        var initialCalendar = this.component.context.calendar;\n        var prevCalendar = this.receivingCalendar;\n        // does the previous calendar need to be cleared?\n        if (prevCalendar && prevCalendar !== nextCalendar) {\n            // does the initial calendar need to be cleared?\n            // if so, don't clear all the way. we still need to to hide the affectedEvents\n            if (prevCalendar === initialCalendar) {\n                prevCalendar.dispatch({\n                    type: 'SET_EVENT_DRAG',\n                    state: {\n                        affectedEvents: state.affectedEvents,\n                        mutatedEvents: createEmptyEventStore(),\n                        isEvent: true,\n                        origSeg: state.origSeg\n                    }\n                });\n                // completely clear the old calendar if it wasn't the initial\n            }\n            else {\n                prevCalendar.dispatch({ type: 'UNSET_EVENT_DRAG' });\n            }\n        }\n        if (nextCalendar) {\n            nextCalendar.dispatch({ type: 'SET_EVENT_DRAG', state: state });\n        }\n    };\n    EventDragging.prototype.clearDrag = function () {\n        var initialCalendar = this.component.context.calendar;\n        var receivingCalendar = this.receivingCalendar;\n        if (receivingCalendar) {\n            receivingCalendar.dispatch({ type: 'UNSET_EVENT_DRAG' });\n        }\n        // the initial calendar might have an dummy drag state from displayDrag\n        if (initialCalendar !== receivingCalendar) {\n            initialCalendar.dispatch({ type: 'UNSET_EVENT_DRAG' });\n        }\n    };\n    EventDragging.prototype.cleanup = function () {\n        this.subjectSeg = null;\n        this.isDragging = false;\n        this.eventRange = null;\n        this.relevantEvents = null;\n        this.receivingCalendar = null;\n        this.validMutation = null;\n        this.mutatedRelevantEvents = null;\n    };\n    EventDragging.SELECTOR = '.fc-draggable, .fc-resizable'; // TODO: test this in IE11\n    return EventDragging;\n}(Interaction));\nfunction computeEventMutation(hit0, hit1, massagers) {\n    var dateSpan0 = hit0.dateSpan;\n    var dateSpan1 = hit1.dateSpan;\n    var date0 = dateSpan0.range.start;\n    var date1 = dateSpan1.range.start;\n    var standardProps = {};\n    if (dateSpan0.allDay !== dateSpan1.allDay) {\n        standardProps.allDay = dateSpan1.allDay;\n        standardProps.hasEnd = hit1.component.context.options.allDayMaintainDuration;\n        if (dateSpan1.allDay) {\n            // means date1 is already start-of-day,\n            // but date0 needs to be converted\n            date0 = startOfDay(date0);\n        }\n    }\n    var delta = diffDates(date0, date1, hit0.component.context.dateEnv, hit0.component === hit1.component ?\n        hit0.component.largeUnit :\n        null);\n    if (delta.milliseconds) { // has hours/minutes/seconds\n        standardProps.allDay = false;\n    }\n    var mutation = {\n        datesDelta: delta,\n        standardProps: standardProps\n    };\n    for (var _i = 0, massagers_1 = massagers; _i < massagers_1.length; _i++) {\n        var massager = massagers_1[_i];\n        massager(mutation, hit0, hit1);\n    }\n    return mutation;\n}\nfunction getComponentTouchDelay$1(component) {\n    var options = component.context.options;\n    var delay = options.eventLongPressDelay;\n    if (delay == null) {\n        delay = options.longPressDelay;\n    }\n    return delay;\n}\n\nvar EventDragging$1 = /** @class */ (function (_super) {\n    __extends(EventDragging, _super);\n    function EventDragging(settings) {\n        var _this = _super.call(this, settings) || this;\n        // internal state\n        _this.draggingSeg = null; // TODO: rename to resizingSeg? subjectSeg?\n        _this.eventRange = null;\n        _this.relevantEvents = null;\n        _this.validMutation = null;\n        _this.mutatedRelevantEvents = null;\n        _this.handlePointerDown = function (ev) {\n            var component = _this.component;\n            var seg = _this.querySeg(ev);\n            var eventRange = _this.eventRange = seg.eventRange;\n            _this.dragging.minDistance = component.context.options.eventDragMinDistance;\n            // if touch, need to be working with a selected event\n            _this.dragging.setIgnoreMove(!_this.component.isValidSegDownEl(ev.origEvent.target) ||\n                (ev.isTouch && _this.component.props.eventSelection !== eventRange.instance.instanceId));\n        };\n        _this.handleDragStart = function (ev) {\n            var _a = _this.component.context, calendar = _a.calendar, view = _a.view;\n            var eventRange = _this.eventRange;\n            _this.relevantEvents = getRelevantEvents(calendar.state.eventStore, _this.eventRange.instance.instanceId);\n            _this.draggingSeg = _this.querySeg(ev);\n            calendar.unselect();\n            calendar.publiclyTrigger('eventResizeStart', [\n                {\n                    el: _this.draggingSeg.el,\n                    event: new EventApi(calendar, eventRange.def, eventRange.instance),\n                    jsEvent: ev.origEvent,\n                    view: view\n                }\n            ]);\n        };\n        _this.handleHitUpdate = function (hit, isFinal, ev) {\n            var calendar = _this.component.context.calendar;\n            var relevantEvents = _this.relevantEvents;\n            var initialHit = _this.hitDragging.initialHit;\n            var eventInstance = _this.eventRange.instance;\n            var mutation = null;\n            var mutatedRelevantEvents = null;\n            var isInvalid = false;\n            var interaction = {\n                affectedEvents: relevantEvents,\n                mutatedEvents: createEmptyEventStore(),\n                isEvent: true,\n                origSeg: _this.draggingSeg\n            };\n            if (hit) {\n                mutation = computeMutation(initialHit, hit, ev.subjectEl.classList.contains('fc-start-resizer'), eventInstance.range, calendar.pluginSystem.hooks.eventResizeJoinTransforms);\n            }\n            if (mutation) {\n                mutatedRelevantEvents = applyMutationToEventStore(relevantEvents, calendar.eventUiBases, mutation, calendar);\n                interaction.mutatedEvents = mutatedRelevantEvents;\n                if (!_this.component.isInteractionValid(interaction)) {\n                    isInvalid = true;\n                    mutation = null;\n                    mutatedRelevantEvents = null;\n                    interaction.mutatedEvents = null;\n                }\n            }\n            if (mutatedRelevantEvents) {\n                calendar.dispatch({\n                    type: 'SET_EVENT_RESIZE',\n                    state: interaction\n                });\n            }\n            else {\n                calendar.dispatch({ type: 'UNSET_EVENT_RESIZE' });\n            }\n            if (!isInvalid) {\n                enableCursor();\n            }\n            else {\n                disableCursor();\n            }\n            if (!isFinal) {\n                if (mutation && isHitsEqual(initialHit, hit)) {\n                    mutation = null;\n                }\n                _this.validMutation = mutation;\n                _this.mutatedRelevantEvents = mutatedRelevantEvents;\n            }\n        };\n        _this.handleDragEnd = function (ev) {\n            var _a = _this.component.context, calendar = _a.calendar, view = _a.view;\n            var eventDef = _this.eventRange.def;\n            var eventInstance = _this.eventRange.instance;\n            var eventApi = new EventApi(calendar, eventDef, eventInstance);\n            var relevantEvents = _this.relevantEvents;\n            var mutatedRelevantEvents = _this.mutatedRelevantEvents;\n            calendar.publiclyTrigger('eventResizeStop', [\n                {\n                    el: _this.draggingSeg.el,\n                    event: eventApi,\n                    jsEvent: ev.origEvent,\n                    view: view\n                }\n            ]);\n            if (_this.validMutation) {\n                calendar.dispatch({\n                    type: 'MERGE_EVENTS',\n                    eventStore: mutatedRelevantEvents\n                });\n                calendar.publiclyTrigger('eventResize', [\n                    {\n                        el: _this.draggingSeg.el,\n                        startDelta: _this.validMutation.startDelta || createDuration(0),\n                        endDelta: _this.validMutation.endDelta || createDuration(0),\n                        prevEvent: eventApi,\n                        event: new EventApi(// the data AFTER the mutation\n                        calendar, mutatedRelevantEvents.defs[eventDef.defId], eventInstance ? mutatedRelevantEvents.instances[eventInstance.instanceId] : null),\n                        revert: function () {\n                            calendar.dispatch({\n                                type: 'MERGE_EVENTS',\n                                eventStore: relevantEvents\n                            });\n                        },\n                        jsEvent: ev.origEvent,\n                        view: view\n                    }\n                ]);\n            }\n            else {\n                calendar.publiclyTrigger('_noEventResize');\n            }\n            // reset all internal state\n            _this.draggingSeg = null;\n            _this.relevantEvents = null;\n            _this.validMutation = null;\n            // okay to keep eventInstance around. useful to set it in handlePointerDown\n        };\n        var component = settings.component;\n        var dragging = _this.dragging = new FeaturefulElementDragging(component.el);\n        dragging.pointer.selector = '.fc-resizer';\n        dragging.touchScrollAllowed = false;\n        dragging.autoScroller.isEnabled = component.context.options.dragScroll;\n        var hitDragging = _this.hitDragging = new HitDragging(_this.dragging, interactionSettingsToStore(settings));\n        hitDragging.emitter.on('pointerdown', _this.handlePointerDown);\n        hitDragging.emitter.on('dragstart', _this.handleDragStart);\n        hitDragging.emitter.on('hitupdate', _this.handleHitUpdate);\n        hitDragging.emitter.on('dragend', _this.handleDragEnd);\n        return _this;\n    }\n    EventDragging.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    EventDragging.prototype.querySeg = function (ev) {\n        return getElSeg(elementClosest(ev.subjectEl, this.component.fgSegSelector));\n    };\n    return EventDragging;\n}(Interaction));\nfunction computeMutation(hit0, hit1, isFromStart, instanceRange, transforms) {\n    var dateEnv = hit0.component.context.dateEnv;\n    var date0 = hit0.dateSpan.range.start;\n    var date1 = hit1.dateSpan.range.start;\n    var delta = diffDates(date0, date1, dateEnv, hit0.component.largeUnit);\n    var props = {};\n    for (var _i = 0, transforms_1 = transforms; _i < transforms_1.length; _i++) {\n        var transform = transforms_1[_i];\n        var res = transform(hit0, hit1);\n        if (res === false) {\n            return null;\n        }\n        else if (res) {\n            __assign(props, res);\n        }\n    }\n    if (isFromStart) {\n        if (dateEnv.add(instanceRange.start, delta) < instanceRange.end) {\n            props.startDelta = delta;\n            return props;\n        }\n    }\n    else {\n        if (dateEnv.add(instanceRange.end, delta) > instanceRange.start) {\n            props.endDelta = delta;\n            return props;\n        }\n    }\n    return null;\n}\n\nvar UnselectAuto = /** @class */ (function () {\n    function UnselectAuto(calendar) {\n        var _this = this;\n        this.isRecentPointerDateSelect = false; // wish we could use a selector to detect date selection, but uses hit system\n        this.onSelect = function (selectInfo) {\n            if (selectInfo.jsEvent) {\n                _this.isRecentPointerDateSelect = true;\n            }\n        };\n        this.onDocumentPointerUp = function (pev) {\n            var _a = _this, calendar = _a.calendar, documentPointer = _a.documentPointer;\n            var state = calendar.state;\n            // touch-scrolling should never unfocus any type of selection\n            if (!documentPointer.wasTouchScroll) {\n                if (state.dateSelection && // an existing date selection?\n                    !_this.isRecentPointerDateSelect // a new pointer-initiated date selection since last onDocumentPointerUp?\n                ) {\n                    var unselectAuto = calendar.viewOpt('unselectAuto');\n                    var unselectCancel = calendar.viewOpt('unselectCancel');\n                    if (unselectAuto && (!unselectAuto || !elementClosest(documentPointer.downEl, unselectCancel))) {\n                        calendar.unselect(pev);\n                    }\n                }\n                if (state.eventSelection && // an existing event selected?\n                    !elementClosest(documentPointer.downEl, EventDragging.SELECTOR) // interaction DIDN'T start on an event\n                ) {\n                    calendar.dispatch({ type: 'UNSELECT_EVENT' });\n                }\n            }\n            _this.isRecentPointerDateSelect = false;\n        };\n        this.calendar = calendar;\n        var documentPointer = this.documentPointer = new PointerDragging(document);\n        documentPointer.shouldIgnoreMove = true;\n        documentPointer.shouldWatchScroll = false;\n        documentPointer.emitter.on('pointerup', this.onDocumentPointerUp);\n        /*\n        TODO: better way to know about whether there was a selection with the pointer\n        */\n        calendar.on('select', this.onSelect);\n    }\n    UnselectAuto.prototype.destroy = function () {\n        this.calendar.off('select', this.onSelect);\n        this.documentPointer.destroy();\n    };\n    return UnselectAuto;\n}());\n\n/*\nGiven an already instantiated draggable object for one-or-more elements,\nInterprets any dragging as an attempt to drag an events that lives outside\nof a calendar onto a calendar.\n*/\nvar ExternalElementDragging = /** @class */ (function () {\n    function ExternalElementDragging(dragging, suppliedDragMeta) {\n        var _this = this;\n        this.receivingCalendar = null;\n        this.droppableEvent = null; // will exist for all drags, even if create:false\n        this.suppliedDragMeta = null;\n        this.dragMeta = null;\n        this.handleDragStart = function (ev) {\n            _this.dragMeta = _this.buildDragMeta(ev.subjectEl);\n        };\n        this.handleHitUpdate = function (hit, isFinal, ev) {\n            var dragging = _this.hitDragging.dragging;\n            var receivingCalendar = null;\n            var droppableEvent = null;\n            var isInvalid = false;\n            var interaction = {\n                affectedEvents: createEmptyEventStore(),\n                mutatedEvents: createEmptyEventStore(),\n                isEvent: _this.dragMeta.create,\n                origSeg: null\n            };\n            if (hit) {\n                receivingCalendar = hit.component.context.calendar;\n                if (_this.canDropElOnCalendar(ev.subjectEl, receivingCalendar)) {\n                    droppableEvent = computeEventForDateSpan(hit.dateSpan, _this.dragMeta, receivingCalendar);\n                    interaction.mutatedEvents = eventTupleToStore(droppableEvent);\n                    isInvalid = !isInteractionValid(interaction, receivingCalendar);\n                    if (isInvalid) {\n                        interaction.mutatedEvents = createEmptyEventStore();\n                        droppableEvent = null;\n                    }\n                }\n            }\n            _this.displayDrag(receivingCalendar, interaction);\n            // show mirror if no already-rendered mirror element OR if we are shutting down the mirror (?)\n            // TODO: wish we could somehow wait for dispatch to guarantee render\n            dragging.setMirrorIsVisible(isFinal || !droppableEvent || !document.querySelector('.fc-mirror'));\n            if (!isInvalid) {\n                enableCursor();\n            }\n            else {\n                disableCursor();\n            }\n            if (!isFinal) {\n                dragging.setMirrorNeedsRevert(!droppableEvent);\n                _this.receivingCalendar = receivingCalendar;\n                _this.droppableEvent = droppableEvent;\n            }\n        };\n        this.handleDragEnd = function (pev) {\n            var _a = _this, receivingCalendar = _a.receivingCalendar, droppableEvent = _a.droppableEvent;\n            _this.clearDrag();\n            if (receivingCalendar && droppableEvent) {\n                var finalHit = _this.hitDragging.finalHit;\n                var finalView = finalHit.component.context.view;\n                var dragMeta = _this.dragMeta;\n                var arg = __assign({}, receivingCalendar.buildDatePointApi(finalHit.dateSpan), { draggedEl: pev.subjectEl, jsEvent: pev.origEvent, view: finalView });\n                receivingCalendar.publiclyTrigger('drop', [arg]);\n                if (dragMeta.create) {\n                    receivingCalendar.dispatch({\n                        type: 'MERGE_EVENTS',\n                        eventStore: eventTupleToStore(droppableEvent)\n                    });\n                    if (pev.isTouch) {\n                        receivingCalendar.dispatch({\n                            type: 'SELECT_EVENT',\n                            eventInstanceId: droppableEvent.instance.instanceId\n                        });\n                    }\n                    // signal that an external event landed\n                    receivingCalendar.publiclyTrigger('eventReceive', [\n                        {\n                            draggedEl: pev.subjectEl,\n                            event: new EventApi(receivingCalendar, droppableEvent.def, droppableEvent.instance),\n                            view: finalView\n                        }\n                    ]);\n                }\n            }\n            _this.receivingCalendar = null;\n            _this.droppableEvent = null;\n        };\n        var hitDragging = this.hitDragging = new HitDragging(dragging, interactionSettingsStore);\n        hitDragging.requireInitial = false; // will start outside of a component\n        hitDragging.emitter.on('dragstart', this.handleDragStart);\n        hitDragging.emitter.on('hitupdate', this.handleHitUpdate);\n        hitDragging.emitter.on('dragend', this.handleDragEnd);\n        this.suppliedDragMeta = suppliedDragMeta;\n    }\n    ExternalElementDragging.prototype.buildDragMeta = function (subjectEl) {\n        if (typeof this.suppliedDragMeta === 'object') {\n            return parseDragMeta(this.suppliedDragMeta);\n        }\n        else if (typeof this.suppliedDragMeta === 'function') {\n            return parseDragMeta(this.suppliedDragMeta(subjectEl));\n        }\n        else {\n            return getDragMetaFromEl(subjectEl);\n        }\n    };\n    ExternalElementDragging.prototype.displayDrag = function (nextCalendar, state) {\n        var prevCalendar = this.receivingCalendar;\n        if (prevCalendar && prevCalendar !== nextCalendar) {\n            prevCalendar.dispatch({ type: 'UNSET_EVENT_DRAG' });\n        }\n        if (nextCalendar) {\n            nextCalendar.dispatch({ type: 'SET_EVENT_DRAG', state: state });\n        }\n    };\n    ExternalElementDragging.prototype.clearDrag = function () {\n        if (this.receivingCalendar) {\n            this.receivingCalendar.dispatch({ type: 'UNSET_EVENT_DRAG' });\n        }\n    };\n    ExternalElementDragging.prototype.canDropElOnCalendar = function (el, receivingCalendar) {\n        var dropAccept = receivingCalendar.opt('dropAccept');\n        if (typeof dropAccept === 'function') {\n            return dropAccept(el);\n        }\n        else if (typeof dropAccept === 'string' && dropAccept) {\n            return Boolean(elementMatches(el, dropAccept));\n        }\n        return true;\n    };\n    return ExternalElementDragging;\n}());\n// Utils for computing event store from the DragMeta\n// ----------------------------------------------------------------------------------------------------\nfunction computeEventForDateSpan(dateSpan, dragMeta, calendar) {\n    var defProps = __assign({}, dragMeta.leftoverProps);\n    for (var _i = 0, _a = calendar.pluginSystem.hooks.externalDefTransforms; _i < _a.length; _i++) {\n        var transform = _a[_i];\n        __assign(defProps, transform(dateSpan, dragMeta));\n    }\n    var def = parseEventDef(defProps, dragMeta.sourceId, dateSpan.allDay, calendar.opt('forceEventDuration') || Boolean(dragMeta.duration), // hasEnd\n    calendar);\n    var start = dateSpan.range.start;\n    // only rely on time info if drop zone is all-day,\n    // otherwise, we already know the time\n    if (dateSpan.allDay && dragMeta.startTime) {\n        start = calendar.dateEnv.add(start, dragMeta.startTime);\n    }\n    var end = dragMeta.duration ?\n        calendar.dateEnv.add(start, dragMeta.duration) :\n        calendar.getDefaultEventEnd(dateSpan.allDay, start);\n    var instance = createEventInstance(def.defId, { start: start, end: end });\n    return { def: def, instance: instance };\n}\n// Utils for extracting data from element\n// ----------------------------------------------------------------------------------------------------\nfunction getDragMetaFromEl(el) {\n    var str = getEmbeddedElData(el, 'event');\n    var obj = str ?\n        JSON.parse(str) :\n        { create: false }; // if no embedded data, assume no event creation\n    return parseDragMeta(obj);\n}\nconfig.dataAttrPrefix = '';\nfunction getEmbeddedElData(el, name) {\n    var prefix = config.dataAttrPrefix;\n    var prefixedName = (prefix ? prefix + '-' : '') + name;\n    return el.getAttribute('data-' + prefixedName) || '';\n}\n\n/*\nMakes an element (that is *external* to any calendar) draggable.\nCan pass in data that determines how an event will be created when dropped onto a calendar.\nLeverages FullCalendar's internal drag-n-drop functionality WITHOUT a third-party drag system.\n*/\nvar ExternalDraggable = /** @class */ (function () {\n    function ExternalDraggable(el, settings) {\n        var _this = this;\n        if (settings === void 0) { settings = {}; }\n        this.handlePointerDown = function (ev) {\n            var dragging = _this.dragging;\n            var _a = _this.settings, minDistance = _a.minDistance, longPressDelay = _a.longPressDelay;\n            dragging.minDistance =\n                minDistance != null ?\n                    minDistance :\n                    (ev.isTouch ? 0 : globalDefaults.eventDragMinDistance);\n            dragging.delay =\n                ev.isTouch ? // TODO: eventually read eventLongPressDelay instead vvv\n                    (longPressDelay != null ? longPressDelay : globalDefaults.longPressDelay) :\n                    0;\n        };\n        this.handleDragStart = function (ev) {\n            if (ev.isTouch &&\n                _this.dragging.delay &&\n                ev.subjectEl.classList.contains('fc-event')) {\n                _this.dragging.mirror.getMirrorEl().classList.add('fc-selected');\n            }\n        };\n        this.settings = settings;\n        var dragging = this.dragging = new FeaturefulElementDragging(el);\n        dragging.touchScrollAllowed = false;\n        if (settings.itemSelector != null) {\n            dragging.pointer.selector = settings.itemSelector;\n        }\n        if (settings.appendTo != null) {\n            dragging.mirror.parentNode = settings.appendTo; // TODO: write tests\n        }\n        dragging.emitter.on('pointerdown', this.handlePointerDown);\n        dragging.emitter.on('dragstart', this.handleDragStart);\n        new ExternalElementDragging(dragging, settings.eventData);\n    }\n    ExternalDraggable.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    return ExternalDraggable;\n}());\n\n/*\nDetects when a *THIRD-PARTY* drag-n-drop system interacts with elements.\nThe third-party system is responsible for drawing the visuals effects of the drag.\nThis class simply monitors for pointer movements and fires events.\nIt also has the ability to hide the moving element (the \"mirror\") during the drag.\n*/\nvar InferredElementDragging = /** @class */ (function (_super) {\n    __extends(InferredElementDragging, _super);\n    function InferredElementDragging(containerEl) {\n        var _this = _super.call(this, containerEl) || this;\n        _this.shouldIgnoreMove = false;\n        _this.mirrorSelector = '';\n        _this.currentMirrorEl = null;\n        _this.handlePointerDown = function (ev) {\n            _this.emitter.trigger('pointerdown', ev);\n            if (!_this.shouldIgnoreMove) {\n                // fire dragstart right away. does not support delay or min-distance\n                _this.emitter.trigger('dragstart', ev);\n            }\n        };\n        _this.handlePointerMove = function (ev) {\n            if (!_this.shouldIgnoreMove) {\n                _this.emitter.trigger('dragmove', ev);\n            }\n        };\n        _this.handlePointerUp = function (ev) {\n            _this.emitter.trigger('pointerup', ev);\n            if (!_this.shouldIgnoreMove) {\n                // fire dragend right away. does not support a revert animation\n                _this.emitter.trigger('dragend', ev);\n            }\n        };\n        var pointer = _this.pointer = new PointerDragging(containerEl);\n        pointer.emitter.on('pointerdown', _this.handlePointerDown);\n        pointer.emitter.on('pointermove', _this.handlePointerMove);\n        pointer.emitter.on('pointerup', _this.handlePointerUp);\n        return _this;\n    }\n    InferredElementDragging.prototype.destroy = function () {\n        this.pointer.destroy();\n    };\n    InferredElementDragging.prototype.setIgnoreMove = function (bool) {\n        this.shouldIgnoreMove = bool;\n    };\n    InferredElementDragging.prototype.setMirrorIsVisible = function (bool) {\n        if (bool) {\n            // restore a previously hidden element.\n            // use the reference in case the selector class has already been removed.\n            if (this.currentMirrorEl) {\n                this.currentMirrorEl.style.visibility = '';\n                this.currentMirrorEl = null;\n            }\n        }\n        else {\n            var mirrorEl = this.mirrorSelector ?\n                document.querySelector(this.mirrorSelector) :\n                null;\n            if (mirrorEl) {\n                this.currentMirrorEl = mirrorEl;\n                mirrorEl.style.visibility = 'hidden';\n            }\n        }\n    };\n    return InferredElementDragging;\n}(ElementDragging));\n\n/*\nBridges third-party drag-n-drop systems with FullCalendar.\nMust be instantiated and destroyed by caller.\n*/\nvar ThirdPartyDraggable = /** @class */ (function () {\n    function ThirdPartyDraggable(containerOrSettings, settings) {\n        var containerEl = document;\n        if (\n        // wish we could just test instanceof EventTarget, but doesn't work in IE11\n        containerOrSettings === document ||\n            containerOrSettings instanceof Element) {\n            containerEl = containerOrSettings;\n            settings = settings || {};\n        }\n        else {\n            settings = (containerOrSettings || {});\n        }\n        var dragging = this.dragging = new InferredElementDragging(containerEl);\n        if (typeof settings.itemSelector === 'string') {\n            dragging.pointer.selector = settings.itemSelector;\n        }\n        else if (containerEl === document) {\n            dragging.pointer.selector = '[data-event]';\n        }\n        if (typeof settings.mirrorSelector === 'string') {\n            dragging.mirrorSelector = settings.mirrorSelector;\n        }\n        new ExternalElementDragging(dragging, settings.eventData);\n    }\n    ThirdPartyDraggable.prototype.destroy = function () {\n        this.dragging.destroy();\n    };\n    return ThirdPartyDraggable;\n}());\n\nvar main = createPlugin({\n    componentInteractions: [DateClicking, DateSelecting, EventDragging, EventDragging$1],\n    calendarInteractions: [UnselectAuto],\n    elementDraggingImpl: FeaturefulElementDragging\n});\n\nexport default main;\nexport { ExternalDraggable as Draggable, FeaturefulElementDragging, PointerDragging, ThirdPartyDraggable };\n"]}